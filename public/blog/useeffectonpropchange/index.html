<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.62 'Libre Baskerville',serif;box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:'Libre Baskerville',serif;font-weight:400;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}h1{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.7rem;color:hsla(0,0%,0%,1);font-family:'Raleway',sans-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;}h2{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;color:hsla(0,0%,0%,1);font-family:'Raleway',sans-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;}h3{margin-left:0;margin-right:0;margin-top:1.33rem;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;color:hsla(0,0%,0%,1);font-family:'Raleway',sans-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.85rem;color:hsla(0,0%,0%,1);font-family:'Raleway',sans-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;color:hsla(0,0%,0%,1);font-family:'Raleway',sans-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;color:hsla(0,0%,0%,1);font-family:'Raleway',sans-serif;font-weight:800;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}ul{margin-left:1.62rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.62rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;font-size:0.85rem;line-height:1.62rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;font-size:1rem;line-height:1.62rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}blockquote{margin-left:1.08rem;margin-right:1.08rem;margin-top:1.08rem;padding-bottom:0;padding-left:1.08rem;padding-right:0;padding-top:0;margin-bottom:1.08rem;color:hsla(0,0%,0%,0.7340000000000001);border-left:4px solid #999;}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(1.08rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.08rem;}b{font-weight:700;}strong{font-weight:700;}dt{font-weight:700;}th{font-weight:700;}li{margin-bottom:calc(1.08rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.62rem;margin-bottom:calc(1.08rem / 2);margin-top:calc(1.08rem / 2);}li > ul{margin-left:1.62rem;margin-bottom:calc(1.08rem / 2);margin-top:calc(1.08rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(1.08rem / 2);}code{font-size:0.95rem;line-height:1.62rem;}kbd{font-size:0.85rem;line-height:1.62rem;}samp{font-size:0.85rem;line-height:1.62rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08rem;padding-right:1.08rem;padding-top:0.81rem;padding-bottom:calc(0.81rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}@media only screen and (max-width:480px){html{font-size:80%;line-height:19.2px;}}a{font-weight:bold;color:#1ca086;text-decoration:none;}a:hover{text-decoration:underline;}a.gatsby-resp-image-link{box-shadow:none;}pre code{font-size:0.85rem;}</style><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=008654519ce705ac7bc44303a9014606"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=008654519ce705ac7bc44303a9014606"/><meta name="generator" content="Gatsby 2.4.3"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=008654519ce705ac7bc44303a9014606"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=008654519ce705ac7bc44303a9014606"/><title data-react-helmet="true">Handy React hooks helper: useEffectOnPropChange() | Helixbassment</title><meta data-react-helmet="true" name="description" content="A common pattern in React is to monitor the value of certain props and “do something” when they
changeThe old way: “prop-diffing” in In the days before React…"/><meta data-react-helmet="true" property="og:title" content="Handy React hooks helper: useEffectOnPropChange()"/><meta data-react-helmet="true" property="og:description" content="A common pattern in React is to monitor the value of certain props and “do something” when they
changeThe old way: “prop-diffing” in In the days before React…"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Julian Rosse"/><meta data-react-helmet="true" name="twitter:title" content="Handy React hooks helper: useEffectOnPropChange()"/><meta data-react-helmet="true" name="twitter:description" content="A common pattern in React is to monitor the value of certain props and “do something” when they
changeThe old way: “prop-diffing” in In the days before React…"/><style data-href="/styles.1025963f4f2ec7abbad4.css">@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-4124805c0503dbfe42dd67d7f5715964.woff2) format("woff2"),url(/static/montserrat-latin-100-c8fb2f714bbc7bc3e8dfffa916b286dc.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e4bf47bd171a9b2a72dd84c58bf90edf.woff2) format("woff2"),url(/static/montserrat-latin-100italic-d1f3f2d02ee4d7d2d4b1ad865014f189.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-444ae007121264bc1969d49b4031f9b2.woff2) format("woff2"),url(/static/montserrat-latin-200-edbce16a90aa22c297a0307b85789837.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-f316c5d1ec40f3e68654c3f38b3999f3.woff2) format("woff2"),url(/static/montserrat-latin-200italic-d7bbb730d9b5e11720b3eb32326dcca7.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-0a7c6df06e85d978d096d4d18fd8d43d.woff2) format("woff2"),url(/static/montserrat-latin-300-5e86df2cad22d2ef2b03516334afae5e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-c076c4892bc7a4be7b9097e97a35012d.woff2) format("woff2"),url(/static/montserrat-latin-300italic-37c74a8d2d0d36a0a2c6e9a37ee15b0c.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-501ce09c42716a2f6e1503a25eb174c9.woff2) format("woff2"),url(/static/montserrat-latin-400-f29d2b8559699b6beb5b29b25b8bc572.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-882908d9950d9c86ebd380877f293d95.woff2) format("woff2"),url(/static/montserrat-latin-400italic-22e7b04e5f2a901d49d4d342315a715a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-f0f2716c5fe401d175b88715e7d28685.woff2) format("woff2"),url(/static/montserrat-latin-500-991b453bf90a0980e78966d2af7e3d3a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-4590ebba421b3288c305305d7fa7b504.woff2) format("woff2"),url(/static/montserrat-latin-500italic-f3d41e4cdcc2314e49ddcea751d6f87f.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-15c24f7109941777774ddd2c636c6a50.woff2) format("woff2"),url(/static/montserrat-latin-600-f6dc6096f48956908c1787d9a722570a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-6d10b80529d5c36c7c09fca7193af0fc.woff2) format("woff2"),url(/static/montserrat-latin-600italic-02c4833312d94b1b0866f073023a250e.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-79982cd1f74c6fa7451bf9b37ead09ff.woff2) format("woff2"),url(/static/montserrat-latin-700-957e93fbbe131a59791cd820d98b7109.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-283438e9577fe6a684466bb100e105ec.woff2) format("woff2"),url(/static/montserrat-latin-700italic-ca627c5ccc65cf80c2ecaea44b997de9.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-35386154b78d046218fc8f88a44ff515.woff2) format("woff2"),url(/static/montserrat-latin-800-756655905d91b77960888262e7d58d35.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-e1b52a7bd83e2324db6d92bdc206844c.woff2) format("woff2"),url(/static/montserrat-latin-800italic-a69f0add9d86c1a84311d7dd8693ba4a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:normal;font-display:swap;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-260c2ea3ef57feb82251952e605a36d5.woff2) format("woff2"),url(/static/montserrat-latin-900-186cae8091da578150d81958e217714a.woff) format("woff")}@font-face{font-family:Montserrat;font-style:italic;font-display:swap;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-d785fb9fc74588ffb7f306799709a97d.woff2) format("woff2"),url(/static/montserrat-latin-900italic-43b527fe77254f97ea36e2b54e845ec4.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-b1158cfcd4aacb9d8fb61625e37af46a.woff2) format("woff2"),url(/static/merriweather-latin-300-cc7de05e166e90320d7d896e0f72a19d.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-8fe52a48089d6ebe46db0b8e7cc66263.woff2) format("woff2"),url(/static/merriweather-latin-300italic-e1331f5397c2a673f9d3765138debdb5.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-8276fdb72ae8f4714d4e6eba704cc39f.woff2) format("woff2"),url(/static/merriweather-latin-400-69f09800f4f6479d06e44eba837df872.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-3a9be9ea9f7aa4af6de7307df21d9fc0.woff2) format("woff2"),url(/static/merriweather-latin-400italic-d76079ed7541a433a54f79316de086e9.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-fa534be7ffa380e39a7f6e03bf9a5e03.woff2) format("woff2"),url(/static/merriweather-latin-700-ba56ea84b8084b7ff9677f50d3cd81bd.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-1ef5edaaa20ae53ea50399884c5e48c6.woff2) format("woff2"),url(/static/merriweather-latin-700italic-534bc9e7ce93c73d73426e46acd78092.woff) format("woff")}@font-face{font-family:Merriweather;font-style:normal;font-display:swap;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-7528fb70e8a4a82c7305e72ff43ac25f.woff2) format("woff2"),url(/static/merriweather-latin-900-3799b6e2f5ed3fcccf9d7a708d7419fa.woff) format("woff")}@font-face{font-family:Merriweather;font-style:italic;font-display:swap;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-e1b4d2aaa78e12ad84aaf8a56321e4c2.woff2) format("woff2"),url(/static/merriweather-latin-900italic-2ae22f731b3424e8dbb4b37f7ca6e708.woff) format("woff")}</style><link href="//fonts.googleapis.com/css?family=Raleway:800|Libre+Baskerville:400,400i,700" rel="stylesheet" type="text/css"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-d7fcdf29c30adea6dd62.js"/><link as="script" rel="preload" href="/0-862666f836174a7cc8e4.js"/><link as="script" rel="preload" href="/app-40f89139f77a1b153b81.js"/><link as="script" rel="preload" href="/styles-5aff52f01899f63c8b09.js"/><link as="script" rel="preload" href="/webpack-runtime-59a92f62769e28635154.js"/><link as="fetch" rel="preload" href="/static/d/505/path---useeffectonpropchange-5-cd-c67-M0TJ1fd228fXA8bltmEdVt9NoA.json" crossorigin="use-credentials"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group"><div style="margin-left:auto;margin-right:auto;max-width:38.88rem;padding:2.43rem 1.215rem"><header><h3 style="font-family:Montserrat, sans-serif;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:inherit" href="/">Helixbassment</a></h3></header><main><h1>Handy React hooks helper: useEffectOnPropChange()</h1><p style="font-size:0.87055rem;line-height:1.62rem;display:block;margin-bottom:1.62rem;margin-top:-1.62rem">June 09, 2019</p><div><p>A common pattern in React is to monitor the value of certain props and “do something” when they
change</p>
<h3>The old way: “prop-diffing” in <code class="language-text">componentDidUpdate()</code></h3>
<p>In the days before React hooks, a typical pattern would be to compare the previous and new values of a certain prop in a
lifecycle method like <code class="language-text">componentDidUpdate()</code> and conditionally “do something” if that prop had changed values in some
particular way</p>
<p>For example:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">class Watcher extends React.Component {
  ...
  componentDidUpdate(prevProps) {
    if (this.props.foo !== prevProps.foo &amp;&amp; this.props.foo === &#39;bar&#39;) {
      console.log(&quot;foo just changed to &#39;bar&#39;&quot;)
    }
  }
}</code></pre></div>
<p>This type of “prop-diffing” always felt pretty boilerplate-y/hard to read - you’re sort of intermixing the mechanics of
inspecting for a certain type of prop change having taken place with the action that should happen if that condition is met</p>
<h3>The new standard: <code class="language-text">useEffect()</code></h3>
<p>These days, using class component lifecycle methods can typically be replaced by React hooks, in this case primarily
<a href="https://reactjs.org/docs/hooks-effect.html"><code class="language-text">useEffect()</code></a></p>
<p>The React hooks docs show us the <a href="https://reactjs.org/docs/hooks-faq.html#how-to-get-the-previous-props-or-state">basic pattern for getting a reference to the previous props</a>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import {useRef, useEffect} from &#39;React&#39;

function usePrevious(value) {
  const ref = useRef()
  useEffect(() =&gt; {
    ref.current = value
  })
  return ref.current
}

const Compare = props =&gt; {
  const prevProps = usePrevious(props) || {}
  return &lt;h1&gt;Previous foo: {prevProps.foo}, current foo: {props.foo}&lt;/h1&gt;
}</code></pre></div>
<p>You can see that the <code class="language-text">usePrevious()</code> helper is using the <code class="language-text">useRef()</code> hook to track the previous value of something (in this case,
the props passed to the <code class="language-text">&lt;Compare&gt;</code> component)</p>
<p>So with <code class="language-text">usePrevious()</code> as a building block, we can create an abstraction that allows us to say “when some particular prop
changes, do something”:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import {find} from &#39;lodash&#39;

const useEffectOnPropChange = (changeProps, callback) =&gt; props =&gt; {
  const prevProps = usePrevious(props) || {}
  useEffect(() =&gt; {
    const changed = find(
      ensureArray(changeProps),
      changeProp =&gt; prevProps[changeProp] !== props[changeProp]
    )
    if (!changed) return null
    return callback(props, prevProps)
  })
}

const Watcher = props =&gt; {
  useEffectOnPropChange(&#39;foo&#39;, ({foo}, prevProps) =&gt; {
    if (foo === &#39;bar&#39; &amp;&amp; prevProps.foo === &#39;baz&#39;) {
      console.log(&quot;foo just changed to &#39;bar&#39; from &#39;baz&#39;&quot;)
    }
  })(props)
  ...
}</code></pre></div>
<p>Here <code class="language-text">ensureArray()</code> is a helper that allows the first argument to <code class="language-text">useEffectOnPropChange()</code> to either be an array of prop
names or a single prop name:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import {isArray} from &#39;lodash&#39;

const ensureArray = maybeArray =&gt;
  isArray(maybeArray) ? maybeArray : [maybeArray]

...
// both of these calling styles work:
useEffectOnPropChange(&#39;foo&#39;, ...)(props)
useEffectOnPropChange([&#39;foo&#39;, &#39;bar&#39;], ...)(props)</code></pre></div>
<p>So with <code class="language-text">useEffectOnPropChange()</code> we’ve given ourselves a more declarative way to indicate that something should happen
whenever a certain prop changes value</p>
<p>This is a lot nicer than manually “prop-diffing” inside <code class="language-text">componentDidUpdate()</code>, but I think there’s room to make it even more
declarative. Basically now <code class="language-text">useEffectOnPropChange()</code> is declarative with respect to <em>which prop we’re watching</em> but not with
respect to <em>under which conditions we care</em> - often times (like in the example above), our condition is actually more specific
than just “the <code class="language-text">foo</code> prop changed”, it’s actually eg “the <code class="language-text">foo</code> prop went from being null to non-null” or “the new value of the
<code class="language-text">foo</code> prop is <code class="language-text">&#39;bar&#39;</code>”</p>
<p>I can picture a couple different ways of making those cases more declarative:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// Maybe these common cases deserve their own name:
useEffectOnPropBecomingTruthy(&#39;foo&#39;, ...)(props)
useEffectOnPropBecomingFalsy(&#39;foo&#39;, ...)(props)

// Here&#39;s one calling interface for specifying the prop change condition separately from the action:
useEffectOnPropChange({foo: (currentFoo, prevFoo) =&gt; currentFoo === &#39;bar&#39; &amp;&amp; prevFoo === &#39;baz&#39;}, ...)(props)

// Or similarly:
useEffectOnPropChangeWhen((props, prevProps) =&gt; props.foo === &#39;bar&#39; &amp;&amp; prevProps.foo === &#39;baz&#39;)(&#39;foo&#39;, ...)(props)</code></pre></div>
<p>These might all be nice ways to express a condition in different situations - the goal is to feel empowered to create the
nice abstractions that you (and others) can then reach for when you encounter a situation where they’d come in handy!</p>
<p>For example, here’s how I might implement <code class="language-text">useEffectOnPropBecomingTruthy()</code>:</p>
<p>First, I think we’re going to need a general way to “inject the condition” into <code class="language-text">useEffectOnPropChange()</code>. Looking at the
ideas for different calling interfaces above, I think it’ll make sense to make <code class="language-text">useEffectOnPropChangeWhen()</code> our underlying
abstraction that all the rest (including <code class="language-text">useEffectOnPropChange()</code>) are built on top of</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const useEffectOnPropChangeWhen = (condition = () =&gt; true) =&gt; (changeProps, callback) =&gt; props =&gt; {
  const prevProps = usePrevious(props) || {}
  useEffect(() =&gt; {
    const changed = find(
      ensureArray(changeProps),
      changeProp =&gt; prevProps[changeProp] !== props[changeProp]
    )
    if (!changed) return null
    if (!condition(props, prevProps)) return null
    return callback(props, prevProps)
  })
}</code></pre></div>
<p>We basically just added another “level of currying” to our previous <code class="language-text">useEffectOnPropChange()</code> implementation in order to
accept the additional <code class="language-text">condition</code></p>
<p>So now we can reimplement <code class="language-text">useEffectOnPropChange()</code> in terms of <code class="language-text">useEffectOnPropChangeWhen()</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const useEffectOnPropChange = (changeProps, callback) =&gt;
  useEffectOnPropChangeWhen()(changeProps, callback)
  
// or just:
const useEffectOnPropChange = useEffectOnPropChangeWhen()</code></pre></div>
<p>And now we can implement variations like <code class="language-text">useEffectOnPropBecomingTruthy()</code> also using <code class="language-text">useEffectOnPropChangeWhen()</code>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const useEffectOnPropBecomingTruthy = (changeProps, callback) =&gt; {
  const arrayOfChangeProps = ensureArray(changeProps)
  const condition = (props, prevProps) =&gt;
    find(arrayOfChangeProps, changeProp =&gt; props[changeProp] &amp;&amp; !prevProps[changeProp])
  return useEffectOnPropChangeWhen(condition)(changeProps, callback)
}</code></pre></div>
<h3>Bonus: use <code class="language-text">ad-hok</code></h3>
<p>These are all nicely declarative <a href="https://reactjs.org/docs/hooks-custom.html">“custom hooks”</a>. But I typically use
<a href="https://github.com/helixbass/ad-hok"><code class="language-text">ad-hok</code></a> to allow composing hooks like this more fluidly</p>
<p>It’s trivial to convert these custom hooks into <code class="language-text">ad-hok</code>-style helpers:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const addEffectOnPropChange = (changeProps, callback) =&gt; {
  const curriedUseEffectOnPropChange = useEffectOnPropChange(changeProps, callback)
  return props =&gt; {
    curriedUseEffectOnPropChange(props)
    return props
  }
}</code></pre></div>
<p>or written in a more functional style:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import {flow} from &#39;lodash/fp&#39;

const addEffectOnPropChange = flow(
  useEffectOnPropChange,
  tap
)</code></pre></div>
<p>where <code class="language-text">tap()</code> is a <a href="https://ramdajs.com/0.21.0/docs/#tap">standard</a> <a href="https://apidock.com/ruby/Object/tap">functional</a> <a href="http://raganwald.com/JQuery-Combinators/">helper</a>:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const tap = callback =&gt; val =&gt; {
  callback(val)
  return val
}</code></pre></div>
<p>The above is elegantly simple but might be hard to visualize, so here’s a version where the flow of arguments is more explicit:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const addEffectOnPropChange = flow(
  (changeProps, callback) =&gt; useEffectOnPropChange(changeProps, callback),
  curriedUseEffectOnPropChange =&gt; {
    return props =&gt; {
      curriedUseEffectOnPropChange(props)
      return props
    }
  }
)</code></pre></div>
<p>Then we can use <code class="language-text">addEffectOnPropChange()</code> in an <code class="language-text">ad-hok</code>-style component:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">const Watcher = flow(
  addEffectOnPropChange(&#39;foo&#39;, ({foo}, prevProps) =&gt; {
    if (foo === &#39;bar&#39; &amp;&amp; prevProps.foo === &#39;baz&#39;) {
      console.log(&quot;foo just changed to &#39;bar&#39; from &#39;baz&#39;&quot;)
    }
  }),
  ...
)</code></pre></div>
<h3>Practical use case: tracking current language</h3>
<p>In the current project I’m working on, we’re using <a href="https://www.i18next.com/"><code class="language-text">i18next</code></a>/<a href="https://react.i18next.com/"><code class="language-text">react-i18next</code></a>
for internationalization support (translations)</p>
<p>It seems as though <code class="language-text">i18next</code> expects to be the “source of truth” for what the currently selected language is. But that felt
somewhat at odds with our Redux store being the source of truth for most similar state. And at some point I felt like I was
seeing wonky/flaky updating of <code class="language-text">i18next</code>’s version of what the currently selected language is</p>
<p>So at that point I decided to move the current language “source of truth” into our Redux store and have <code class="language-text">i18next</code>’s idea of
the current language be informed by our Redux store</p>
<p>There may be a more idiomatic way of “broadcasting” a value from your Redux store, but the way I achieved this was to create
a component (that gets mounted at the root level of our application) whose sole purpose is to listen to the Redux store for
changes to the current language and inform <code class="language-text">i18next</code> of that change:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">import {connect} from &#39;react-redux&#39;
import {flowMax, renderNothing} from &#39;ad-hok&#39;
import i18n from &#39;i18next&#39;
import PropTypes from &#39;prop-types&#39;

import {languageSelector} from &#39;redux-local/selectors&#39;
import addEffectOnPropChange from &#39;util/addEffectOnPropChange&#39;

const enhance = connect(languageSelector)

const WatchLanguage = flowMax(
  ...
  addEffectOnPropChange(&#39;currentLanguage&#39;, ({currentLanguage}) =&gt; {
    i18n.changeLanguage(currentLanguage)
  }),
  renderNothing()
)

WatchLanguage.propTypes = {
  currentLanguage: PropTypes.string.isRequired,
}

export default enhance(WatchLanguage)</code></pre></div>
<p><code class="language-text">addEffectOnPropChange()</code> makes it super easy to fire off the call to <code class="language-text">i18n.changeLanguage()</code> whenever our Redux store’s
<code class="language-text">currentLanguage</code> changes</p></div><hr style="margin-bottom:1.62rem"/><div style="display:flex;margin-bottom:4.05rem"><p>Written by <strong>Julian Rosse</strong> who lives and works in NYC.</p></div><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/slack-personal-activity-channel/">← <!-- -->Slack tip: personal activity channel</a></li><li><a rel="next" href="/dynamic-portal/">Using dynamic portals in React to “play nice with” autoplay policy<!-- --> →</a></li></ul></main><footer>© <!-- -->2019<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'undefined', 'auto', {});
      
      
      
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.page={"componentChunkName":"component---src-templates-blog-post-js","jsonName":"useeffectonpropchange-5cd","path":"/useeffectonpropchange/"};window.dataPath="505/path---useeffectonpropchange-5-cd-c67-M0TJ1fd228fXA8bltmEdVt9NoA";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-40f89139f77a1b153b81.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-78f9e4dea04737fa062d.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-d7fcdf29c30adea6dd62.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e24b7a1137083a520816.js"],"component---src-pages-index-js":["/component---src-pages-index-js-06054d2c28cc7b9a0fbc.js"],"pages-manifest":["/pages-manifest-9332fa67d04574250a1b.js"]};/*]]>*/</script><script src="/webpack-runtime-59a92f62769e28635154.js" async=""></script><script src="/styles-5aff52f01899f63c8b09.js" async=""></script><script src="/app-40f89139f77a1b153b81.js" async=""></script><script src="/0-862666f836174a7cc8e4.js" async=""></script><script src="/component---src-templates-blog-post-js-d7fcdf29c30adea6dd62.js" async=""></script></body></html>